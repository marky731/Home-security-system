from picamera2 import Picamera2
import cv2
import numpy as np


# Initialize camera
picam2 = Picamera2()
picam2.preview_configuration.main.size = (1280, 720)  # Set the resolution
picam2.preview_configuration.main.format = "RGB888"  # Set the format

picam2.set_controls({"FrameDurationLimits": (33333, 33333)})

# Start the camera
picam2.start()


while True:
    # Capture the frame
    frame = picam2.capture_array()

    correction_matrix = np.array([[1, 0, 0], [0, 1, 0], [0, 0, 0.5]])  # Adjust these values
    corrected_frame = cv2.transform(frame, correction_matrix)
    cv2.imshow("Camera feed with Color Correction", corrected_frame)

    # Break loop with 'q' key
    if cv2.waitKey(1) & 0xFF == ord('q'):
        break

# Release resources
cv2.destroyAllWindows()
picam2.close()
